{"ast":null,"code":"var _jsxFileName = \"/home/matsuyama/claude/git/game/src/App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport GameDisplay from './components/GameDisplay';\nimport StatsPanel from './components/StatsPanel';\nimport UpgradePanel from './components/UpgradePanel';\nimport TitleNotification from './components/TitleNotification';\nimport BattleLog from './components/BattleLog';\nimport Collection from './components/Collection';\nimport MagicPanel from './components/MagicPanel';\nimport { checkNewTitleUnlocks } from './data/characterData';\nimport { getRandomItemDrop } from './data/itemData';\nimport { getCurrentDungeon, getRandomMonsterFromDungeon } from './data/dungeonData';\nimport { getRandomPhrase, getSpellDamageBonus, getSpellUpgradeCost, getAvailableSpells } from './data/magicData';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  const [gameState, setGameState] = useState({\n    player: {\n      x: 100,\n      y: 300,\n      width: 60,\n      height: 80,\n      hp: 100,\n      maxHp: 100,\n      level: 1,\n      exp: 0,\n      expMax: 100,\n      attack: 10,\n      gold: 0,\n      animFrame: 0,\n      animSpeed: 0.1,\n      isAttacking: false,\n      attackCooldown: 0\n    },\n    monsters: [],\n    currentFloor: 1,\n    currentDungeonId: 'forest',\n    autoAttack: false,\n    particles: [],\n    damageTexts: [],\n    unlockedTitles: ['novice'],\n    titleNotifications: [],\n    battleLog: [],\n    collection: [],\n    magicSpells: {\n      'fire_bolt': 1 // Start with Fire Bolt level 1\n    },\n    currentSpell: 'fire_bolt'\n  });\n  const autoAttackRef = useRef(null);\n  const [currentAttackPhrase, setCurrentAttackPhrase] = useState('');\n  const spawnMonster = useCallback(() => {\n    const currentDungeon = getCurrentDungeon(gameState.currentFloor);\n    const floorMultiplier = 1 + (gameState.currentFloor - 1) * 0.3;\n    const dungeonMonster = getRandomMonsterFromDungeon(currentDungeon.id, floorMultiplier);\n    if (!dungeonMonster) {\n      // Fallback to basic monster\n      const monster = {\n        x: 600,\n        y: 250,\n        width: 80,\n        height: 100,\n        hp: Math.floor(20 * floorMultiplier),\n        maxHp: Math.floor(20 * floorMultiplier),\n        name: 'スライム',\n        color: '#00ff00',\n        animFrame: 0,\n        animSpeed: 0.05\n      };\n      setGameState(prevState => ({\n        ...prevState,\n        monsters: [...prevState.monsters, monster]\n      }));\n      return;\n    }\n    const monster = {\n      x: 600,\n      y: 250,\n      width: 80,\n      height: 100,\n      hp: dungeonMonster.hp,\n      maxHp: dungeonMonster.hp,\n      name: dungeonMonster.name,\n      color: dungeonMonster.color,\n      animFrame: 0,\n      animSpeed: 0.05\n    };\n    setGameState(prevState => ({\n      ...prevState,\n      monsters: [...prevState.monsters, monster],\n      currentDungeonId: currentDungeon.id\n    }));\n  }, [gameState.currentFloor]);\n  useEffect(() => {\n    spawnMonster();\n  }, []);\n  useEffect(() => {\n    if (gameState.autoAttack && !autoAttackRef.current) {\n      autoAttackRef.current = setInterval(() => {\n        setGameState(prevState => {\n          if (!prevState.player.isAttacking && prevState.monsters.length > 0) {\n            return handleAttack(prevState);\n          }\n          return prevState;\n        });\n      }, 1000);\n    } else if (!gameState.autoAttack && autoAttackRef.current) {\n      clearInterval(autoAttackRef.current);\n      autoAttackRef.current = null;\n    }\n    return () => {\n      if (autoAttackRef.current) {\n        clearInterval(autoAttackRef.current);\n      }\n    };\n  }, [gameState.autoAttack]);\n  const addToBattleLog = useCallback(newLog => {\n    setGameState(prevState => ({\n      ...prevState,\n      battleLog: [{\n        ...newLog,\n        id: Date.now() + Math.random()\n      }, ...prevState.battleLog.slice(0, 49) // Keep only last 50 logs\n      ]\n    }));\n  }, []);\n  const addToCollection = useCallback(item => {\n    setGameState(prevState => {\n      const existingItem = prevState.collection.find(c => c.item.id === item.id);\n      if (existingItem) {\n        return {\n          ...prevState,\n          collection: prevState.collection.map(c => c.item.id === item.id ? {\n            ...c,\n            quantity: c.quantity + 1\n          } : c)\n        };\n      } else {\n        return {\n          ...prevState,\n          collection: [...prevState.collection, {\n            item,\n            quantity: 1,\n            firstObtained: new Date()\n          }]\n        };\n      }\n    });\n  }, []);\n  const handleAttack = useCallback((currentState = gameState) => {\n    if (currentState.monsters.length === 0) return currentState;\n\n    // Generate random attack phrase based on current spell\n    const currentSpellLevel = currentState.magicSpells[currentState.currentSpell] || 1;\n    const attackPhrase = getRandomPhrase(currentState.currentSpell, currentSpellLevel);\n    setCurrentAttackPhrase(attackPhrase);\n\n    // Add attack to battle log\n    setTimeout(() => {\n      addToBattleLog({\n        timestamp: new Date(),\n        type: 'attack',\n        message: `セラフィナが攻撃しました`,\n        attackPhrase\n      });\n    }, 100);\n    const monster = currentState.monsters[0];\n    const spellBonus = getSpellDamageBonus(currentState.currentSpell, currentSpellLevel);\n    const damage = currentState.player.attack + spellBonus + Math.floor(Math.random() * 5);\n    const updatedMonster = {\n      ...monster,\n      hp: monster.hp - damage\n    };\n    const newDamageTexts = [...currentState.damageTexts, {\n      id: Date.now(),\n      x: monster.x + monster.width / 2,\n      y: monster.y,\n      text: damage.toString(),\n      color: '#ff6b6b',\n      life: 60,\n      maxLife: 60\n    }];\n    const newParticles = [...currentState.particles];\n    for (let i = 0; i < 8; i++) {\n      newParticles.push({\n        id: Date.now() + i,\n        x: monster.x + monster.width / 2,\n        y: monster.y + monster.height / 2,\n        vx: (Math.random() - 0.5) * 4,\n        vy: (Math.random() - 0.5) * 4,\n        color: '#ff6b6b',\n        life: 20,\n        maxLife: 20\n      });\n    }\n    let newState = {\n      ...currentState,\n      player: {\n        ...currentState.player,\n        isAttacking: true,\n        attackCooldown: 0\n      },\n      monsters: [updatedMonster, ...currentState.monsters.slice(1)],\n      damageTexts: newDamageTexts,\n      particles: newParticles\n    };\n    if (updatedMonster.hp <= 0) {\n      newState = killMonster(newState, updatedMonster);\n    }\n    setTimeout(() => {\n      setGameState(prevState => ({\n        ...prevState,\n        player: {\n          ...prevState.player,\n          isAttacking: false\n        }\n      }));\n    }, 3000); // Changed to 3 seconds\n\n    return newState;\n  }, [gameState]);\n  const killMonster = useCallback((currentState, monster) => {\n    const expGain = Math.floor(monster.maxHp / 2);\n    const goldGain = Math.floor(monster.maxHp / 5) + currentState.currentFloor;\n    let newPlayer = {\n      ...currentState.player,\n      exp: currentState.player.exp + expGain,\n      gold: currentState.player.gold + goldGain\n    };\n    const newDamageTexts = [...currentState.damageTexts, {\n      id: Date.now() + 1000,\n      x: monster.x + monster.width / 2,\n      y: monster.y - 20,\n      text: `+${expGain} EXP`,\n      color: '#00ff00',\n      life: 60,\n      maxLife: 60\n    }, {\n      id: Date.now() + 2000,\n      x: monster.x + monster.width / 2,\n      y: monster.y - 40,\n      text: `+${goldGain} G`,\n      color: '#ffff00',\n      life: 60,\n      maxLife: 60\n    }];\n    if (newPlayer.exp >= newPlayer.expMax) {\n      newPlayer = levelUp(newPlayer);\n      newDamageTexts.push({\n        id: Date.now() + 3000,\n        x: newPlayer.x + newPlayer.width / 2,\n        y: newPlayer.y,\n        text: 'LEVEL UP!',\n        color: '#ff00ff',\n        life: 60,\n        maxLife: 60\n      });\n    }\n\n    // Check for item drop\n    const droppedItem = getRandomItemDrop();\n    if (droppedItem) {\n      setTimeout(() => {\n        addToCollection(droppedItem);\n        addToBattleLog({\n          timestamp: new Date(),\n          type: 'item_drop',\n          message: `${droppedItem.icon} ${droppedItem.name}を獲得しました！`,\n          item: droppedItem\n        });\n      }, 200);\n    }\n\n    // Add monster defeat log\n    setTimeout(() => {\n      addToBattleLog({\n        timestamp: new Date(),\n        type: 'monster_defeat',\n        message: `${monster.name}を倒しました！`\n      });\n    }, 150);\n    setTimeout(() => {\n      spawnMonster();\n    }, 500);\n    return {\n      ...currentState,\n      player: newPlayer,\n      monsters: currentState.monsters.filter(m => m !== monster),\n      damageTexts: newDamageTexts\n    };\n  }, [spawnMonster]);\n  const levelUp = useCallback(player => {\n    const newLevel = player.level + 1;\n    const newPlayer = {\n      ...player,\n      level: newLevel,\n      exp: player.exp - player.expMax,\n      expMax: Math.floor(player.expMax * 1.5),\n      attack: player.attack + 3,\n      maxHp: player.maxHp + 10,\n      hp: player.maxHp + 10\n    };\n\n    // Check for new title unlocks\n    setTimeout(() => {\n      setGameState(prevState => {\n        const newTitleUnlocks = checkNewTitleUnlocks(newLevel, prevState.currentFloor, prevState.unlockedTitles);\n        if (newTitleUnlocks.length > 0) {\n          return {\n            ...prevState,\n            unlockedTitles: [...prevState.unlockedTitles, ...newTitleUnlocks.map(t => t.id)],\n            titleNotifications: [...prevState.titleNotifications, ...newTitleUnlocks.map(t => t.name)]\n          };\n        }\n        return prevState;\n      });\n    }, 100);\n\n    // Add level up to battle log\n    setTimeout(() => {\n      addToBattleLog({\n        timestamp: new Date(),\n        type: 'levelup',\n        message: `レベルが${newLevel}に上がりました！`\n      });\n    }, 300);\n    return newPlayer;\n  }, [addToBattleLog]);\n  const handleCanvasClick = useCallback(() => {\n    if (!gameState.player.isAttacking) {\n      setGameState(handleAttack);\n    }\n  }, [gameState.player.isAttacking, handleAttack]);\n  const handleUpgrade = useCallback(type => {\n    setGameState(prevState => {\n      const newState = {\n        ...prevState\n      };\n      switch (type) {\n        case 'attack':\n          if (newState.player.gold >= 10) {\n            newState.player = {\n              ...newState.player,\n              gold: newState.player.gold - 10,\n              attack: newState.player.attack + 5\n            };\n          }\n          break;\n        case 'autoAttack':\n          if (newState.player.gold >= 50 && !newState.autoAttack) {\n            newState.player = {\n              ...newState.player,\n              gold: newState.player.gold - 50\n            };\n            newState.autoAttack = true;\n          }\n          break;\n        case 'hp':\n          if (newState.player.gold >= 25) {\n            newState.player = {\n              ...newState.player,\n              gold: newState.player.gold - 25,\n              maxHp: newState.player.maxHp + 20,\n              hp: newState.player.maxHp + 20\n            };\n          }\n          break;\n        default:\n          break;\n      }\n      return newState;\n    });\n  }, []);\n  const nextFloor = useCallback(() => {\n    setGameState(prevState => {\n      const newFloor = prevState.currentFloor + 1;\n\n      // Check for new title unlocks based on floor\n      const newTitleUnlocks = checkNewTitleUnlocks(prevState.player.level, newFloor, prevState.unlockedTitles);\n      return {\n        ...prevState,\n        currentFloor: newFloor,\n        monsters: [],\n        unlockedTitles: newTitleUnlocks.length > 0 ? [...prevState.unlockedTitles, ...newTitleUnlocks.map(t => t.id)] : prevState.unlockedTitles,\n        titleNotifications: newTitleUnlocks.length > 0 ? [...prevState.titleNotifications, ...newTitleUnlocks.map(t => t.name)] : prevState.titleNotifications\n      };\n    });\n    setTimeout(() => {\n      spawnMonster();\n    }, 100);\n  }, [spawnMonster]);\n  const handleDismissNotification = useCallback(index => {\n    setGameState(prevState => ({\n      ...prevState,\n      titleNotifications: prevState.titleNotifications.filter((_, i) => i !== index)\n    }));\n  }, []);\n  const handleSpellUpgrade = useCallback(spellId => {\n    setGameState(prevState => {\n      const currentLevel = prevState.magicSpells[spellId] || 0;\n      const cost = currentLevel === 0 ? 0 : getSpellUpgradeCost(spellId, currentLevel);\n      if (currentLevel === 0) {\n        // Unlock spell\n        const availableSpells = getAvailableSpells(prevState.player.level);\n        const spell = availableSpells.find(s => s.id === spellId);\n        if (!spell || prevState.player.level < spell.unlockLevel) return prevState;\n        return {\n          ...prevState,\n          magicSpells: {\n            ...prevState.magicSpells,\n            [spellId]: 1\n          }\n        };\n      } else {\n        // Upgrade spell\n        if (prevState.player.gold < cost) return prevState;\n        return {\n          ...prevState,\n          player: {\n            ...prevState.player,\n            gold: prevState.player.gold - cost\n          },\n          magicSpells: {\n            ...prevState.magicSpells,\n            [spellId]: currentLevel + 1\n          }\n        };\n      }\n    });\n  }, []);\n  const handleSpellSelect = useCallback(spellId => {\n    setGameState(prevState => ({\n      ...prevState,\n      currentSpell: spellId\n    }));\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-container\",\n      children: [/*#__PURE__*/_jsxDEV(GameDisplay, {\n        gameState: gameState,\n        onAttackClick: handleCanvasClick,\n        attackPhrase: currentAttackPhrase\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 494,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ui-panel\",\n        children: [/*#__PURE__*/_jsxDEV(StatsPanel, {\n          player: gameState.player,\n          floor: gameState.currentFloor\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(UpgradePanel, {\n          player: gameState.player,\n          autoAttack: gameState.autoAttack,\n          onUpgrade: handleUpgrade,\n          onNextFloor: nextFloor\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 502,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bottom-panel\",\n        children: [/*#__PURE__*/_jsxDEV(BattleLog, {\n          logs: gameState.battleLog\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 511,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(MagicPanel, {\n          playerLevel: gameState.player.level,\n          playerGold: gameState.player.gold,\n          magicSpells: gameState.magicSpells,\n          currentSpell: gameState.currentSpell,\n          onSpellUpgrade: handleSpellUpgrade,\n          onSpellSelect: handleSpellSelect\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Collection, {\n          collection: gameState.collection\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 520,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 510,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 493,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TitleNotification, {\n      notifications: gameState.titleNotifications,\n      onDismiss: handleDismissNotification\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 492,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"xpLle36RvgkBT2xzoARr5ePwGk4=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","GameDisplay","StatsPanel","UpgradePanel","TitleNotification","BattleLog","Collection","MagicPanel","checkNewTitleUnlocks","getRandomItemDrop","getCurrentDungeon","getRandomMonsterFromDungeon","getRandomPhrase","getSpellDamageBonus","getSpellUpgradeCost","getAvailableSpells","jsxDEV","_jsxDEV","App","_s","gameState","setGameState","player","x","y","width","height","hp","maxHp","level","exp","expMax","attack","gold","animFrame","animSpeed","isAttacking","attackCooldown","monsters","currentFloor","currentDungeonId","autoAttack","particles","damageTexts","unlockedTitles","titleNotifications","battleLog","collection","magicSpells","currentSpell","autoAttackRef","currentAttackPhrase","setCurrentAttackPhrase","spawnMonster","currentDungeon","floorMultiplier","dungeonMonster","id","monster","Math","floor","name","color","prevState","current","setInterval","length","handleAttack","clearInterval","addToBattleLog","newLog","Date","now","random","slice","addToCollection","item","existingItem","find","c","map","quantity","firstObtained","currentState","currentSpellLevel","attackPhrase","setTimeout","timestamp","type","message","spellBonus","damage","updatedMonster","newDamageTexts","text","toString","life","maxLife","newParticles","i","push","vx","vy","newState","killMonster","expGain","goldGain","newPlayer","levelUp","droppedItem","icon","filter","m","newLevel","newTitleUnlocks","t","handleCanvasClick","handleUpgrade","nextFloor","newFloor","handleDismissNotification","index","_","handleSpellUpgrade","spellId","currentLevel","cost","availableSpells","spell","s","unlockLevel","handleSpellSelect","className","children","onAttackClick","fileName","_jsxFileName","lineNumber","columnNumber","onUpgrade","onNextFloor","logs","playerLevel","playerGold","onSpellUpgrade","onSpellSelect","notifications","onDismiss","_c","$RefreshReg$"],"sources":["/home/matsuyama/claude/git/game/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport GameDisplay from './components/GameDisplay';\nimport StatsPanel from './components/StatsPanel';\nimport UpgradePanel from './components/UpgradePanel';\nimport TitleNotification from './components/TitleNotification';\nimport BattleLog from './components/BattleLog';\nimport Collection from './components/Collection';\nimport MagicPanel from './components/MagicPanel';\nimport { GameState, Monster, UpgradeType, Player, DamageText, Particle, BattleLog as BattleLogType, CollectedItem } from './types/gameTypes';\nimport { getRandomAttackPhrase } from './data/attackPhrases';\nimport { checkNewTitleUnlocks, getCurrentTitle } from './data/characterData';\nimport { getRandomItemDrop } from './data/itemData';\nimport { getCurrentDungeon, getRandomMonsterFromDungeon } from './data/dungeonData';\nimport { getRandomPhrase, getSpellDamageBonus, getSpellUpgradeCost, getAvailableSpells } from './data/magicData';\nimport './App.css';\n\nconst App: React.FC = () => {\n  const [gameState, setGameState] = useState<GameState>({\n    player: {\n      x: 100,\n      y: 300,\n      width: 60,\n      height: 80,\n      hp: 100,\n      maxHp: 100,\n      level: 1,\n      exp: 0,\n      expMax: 100,\n      attack: 10,\n      gold: 0,\n      animFrame: 0,\n      animSpeed: 0.1,\n      isAttacking: false,\n      attackCooldown: 0\n    },\n    monsters: [],\n    currentFloor: 1,\n    currentDungeonId: 'forest',\n    autoAttack: false,\n    particles: [],\n    damageTexts: [],\n    unlockedTitles: ['novice'],\n    titleNotifications: [],\n    battleLog: [],\n    collection: [],\n    magicSpells: {\n      'fire_bolt': 1 // Start with Fire Bolt level 1\n    },\n    currentSpell: 'fire_bolt'\n  });\n\n  const autoAttackRef = useRef<NodeJS.Timeout | null>(null);\n  const [currentAttackPhrase, setCurrentAttackPhrase] = useState<string>('');\n\n  const spawnMonster = useCallback(() => {\n    const currentDungeon = getCurrentDungeon(gameState.currentFloor);\n    const floorMultiplier = 1 + (gameState.currentFloor - 1) * 0.3;\n    \n    const dungeonMonster = getRandomMonsterFromDungeon(currentDungeon.id, floorMultiplier);\n    \n    if (!dungeonMonster) {\n      // Fallback to basic monster\n      const monster: Monster = {\n        x: 600,\n        y: 250,\n        width: 80,\n        height: 100,\n        hp: Math.floor(20 * floorMultiplier),\n        maxHp: Math.floor(20 * floorMultiplier),\n        name: 'スライム',\n        color: '#00ff00',\n        animFrame: 0,\n        animSpeed: 0.05\n      };\n      \n      setGameState(prevState => ({\n        ...prevState,\n        monsters: [...prevState.monsters, monster]\n      }));\n      return;\n    }\n\n    const monster: Monster = {\n      x: 600,\n      y: 250,\n      width: 80,\n      height: 100,\n      hp: dungeonMonster.hp,\n      maxHp: dungeonMonster.hp,\n      name: dungeonMonster.name,\n      color: dungeonMonster.color,\n      animFrame: 0,\n      animSpeed: 0.05\n    };\n\n    setGameState(prevState => ({\n      ...prevState,\n      monsters: [...prevState.monsters, monster],\n      currentDungeonId: currentDungeon.id\n    }));\n  }, [gameState.currentFloor]);\n\n  useEffect(() => {\n    spawnMonster();\n  }, []);\n\n  useEffect(() => {\n    if (gameState.autoAttack && !autoAttackRef.current) {\n      autoAttackRef.current = setInterval(() => {\n        setGameState(prevState => {\n          if (!prevState.player.isAttacking && \n              prevState.monsters.length > 0) {\n            return handleAttack(prevState);\n          }\n          return prevState;\n        });\n      }, 1000);\n    } else if (!gameState.autoAttack && autoAttackRef.current) {\n      clearInterval(autoAttackRef.current);\n      autoAttackRef.current = null;\n    }\n\n    return () => {\n      if (autoAttackRef.current) {\n        clearInterval(autoAttackRef.current);\n      }\n    };\n  }, [gameState.autoAttack]);\n\n  const addToBattleLog = useCallback((newLog: Omit<BattleLogType, 'id'>) => {\n    setGameState(prevState => ({\n      ...prevState,\n      battleLog: [\n        {\n          ...newLog,\n          id: Date.now() + Math.random()\n        },\n        ...prevState.battleLog.slice(0, 49) // Keep only last 50 logs\n      ]\n    }));\n  }, []);\n\n  const addToCollection = useCallback((item: any) => {\n    setGameState(prevState => {\n      const existingItem = prevState.collection.find(c => c.item.id === item.id);\n      \n      if (existingItem) {\n        return {\n          ...prevState,\n          collection: prevState.collection.map(c =>\n            c.item.id === item.id\n              ? { ...c, quantity: c.quantity + 1 }\n              : c\n          )\n        };\n      } else {\n        return {\n          ...prevState,\n          collection: [\n            ...prevState.collection,\n            {\n              item,\n              quantity: 1,\n              firstObtained: new Date()\n            }\n          ]\n        };\n      }\n    });\n  }, []);\n\n  const handleAttack = useCallback((currentState: GameState = gameState): GameState => {\n    if (currentState.monsters.length === 0) return currentState;\n\n    // Generate random attack phrase based on current spell\n    const currentSpellLevel = currentState.magicSpells[currentState.currentSpell] || 1;\n    const attackPhrase = getRandomPhrase(currentState.currentSpell, currentSpellLevel);\n    setCurrentAttackPhrase(attackPhrase);\n\n    // Add attack to battle log\n    setTimeout(() => {\n      addToBattleLog({\n        timestamp: new Date(),\n        type: 'attack',\n        message: `セラフィナが攻撃しました`,\n        attackPhrase\n      });\n    }, 100);\n\n    const monster = currentState.monsters[0];\n    const spellBonus = getSpellDamageBonus(currentState.currentSpell, currentSpellLevel);\n    const damage = currentState.player.attack + spellBonus + Math.floor(Math.random() * 5);\n    const updatedMonster: Monster = { ...monster, hp: monster.hp - damage };\n\n    const newDamageTexts: DamageText[] = [...currentState.damageTexts, {\n      id: Date.now(),\n      x: monster.x + monster.width / 2,\n      y: monster.y,\n      text: damage.toString(),\n      color: '#ff6b6b',\n      life: 60,\n      maxLife: 60\n    }];\n\n    const newParticles: Particle[] = [...currentState.particles];\n    for (let i = 0; i < 8; i++) {\n      newParticles.push({\n        id: Date.now() + i,\n        x: monster.x + monster.width / 2,\n        y: monster.y + monster.height / 2,\n        vx: (Math.random() - 0.5) * 4,\n        vy: (Math.random() - 0.5) * 4,\n        color: '#ff6b6b',\n        life: 20,\n        maxLife: 20\n      });\n    }\n\n    let newState: GameState = {\n      ...currentState,\n      player: {\n        ...currentState.player,\n        isAttacking: true,\n        attackCooldown: 0\n      },\n      monsters: [updatedMonster, ...currentState.monsters.slice(1)],\n      damageTexts: newDamageTexts,\n      particles: newParticles\n    };\n\n    if (updatedMonster.hp <= 0) {\n      newState = killMonster(newState, updatedMonster);\n    }\n\n    setTimeout(() => {\n      setGameState(prevState => ({\n        ...prevState,\n        player: {\n          ...prevState.player,\n          isAttacking: false\n        }\n      }));\n    }, 3000); // Changed to 3 seconds\n\n    return newState;\n  }, [gameState]);\n\n  const killMonster = useCallback((currentState: GameState, monster: Monster): GameState => {\n    const expGain = Math.floor(monster.maxHp / 2);\n    const goldGain = Math.floor(monster.maxHp / 5) + currentState.currentFloor;\n\n    let newPlayer: Player = {\n      ...currentState.player,\n      exp: currentState.player.exp + expGain,\n      gold: currentState.player.gold + goldGain\n    };\n\n    const newDamageTexts: DamageText[] = [\n      ...currentState.damageTexts,\n      {\n        id: Date.now() + 1000,\n        x: monster.x + monster.width / 2,\n        y: monster.y - 20,\n        text: `+${expGain} EXP`,\n        color: '#00ff00',\n        life: 60,\n        maxLife: 60\n      },\n      {\n        id: Date.now() + 2000,\n        x: monster.x + monster.width / 2,\n        y: monster.y - 40,\n        text: `+${goldGain} G`,\n        color: '#ffff00',\n        life: 60,\n        maxLife: 60\n      }\n    ];\n\n    if (newPlayer.exp >= newPlayer.expMax) {\n      newPlayer = levelUp(newPlayer);\n      newDamageTexts.push({\n        id: Date.now() + 3000,\n        x: newPlayer.x + newPlayer.width / 2,\n        y: newPlayer.y,\n        text: 'LEVEL UP!',\n        color: '#ff00ff',\n        life: 60,\n        maxLife: 60\n      });\n    }\n\n    // Check for item drop\n    const droppedItem = getRandomItemDrop();\n    if (droppedItem) {\n      setTimeout(() => {\n        addToCollection(droppedItem);\n        addToBattleLog({\n          timestamp: new Date(),\n          type: 'item_drop',\n          message: `${droppedItem.icon} ${droppedItem.name}を獲得しました！`,\n          item: droppedItem\n        });\n      }, 200);\n    }\n\n    // Add monster defeat log\n    setTimeout(() => {\n      addToBattleLog({\n        timestamp: new Date(),\n        type: 'monster_defeat',\n        message: `${monster.name}を倒しました！`\n      });\n    }, 150);\n\n    setTimeout(() => {\n      spawnMonster();\n    }, 500);\n\n    return {\n      ...currentState,\n      player: newPlayer,\n      monsters: currentState.monsters.filter(m => m !== monster),\n      damageTexts: newDamageTexts\n    };\n  }, [spawnMonster]);\n\n  const levelUp = useCallback((player: Player): Player => {\n    const newLevel = player.level + 1;\n    const newPlayer = {\n      ...player,\n      level: newLevel,\n      exp: player.exp - player.expMax,\n      expMax: Math.floor(player.expMax * 1.5),\n      attack: player.attack + 3,\n      maxHp: player.maxHp + 10,\n      hp: player.maxHp + 10\n    };\n\n    // Check for new title unlocks\n    setTimeout(() => {\n      setGameState(prevState => {\n        const newTitleUnlocks = checkNewTitleUnlocks(newLevel, prevState.currentFloor, prevState.unlockedTitles);\n        if (newTitleUnlocks.length > 0) {\n          return {\n            ...prevState,\n            unlockedTitles: [...prevState.unlockedTitles, ...newTitleUnlocks.map(t => t.id)],\n            titleNotifications: [...prevState.titleNotifications, ...newTitleUnlocks.map(t => t.name)]\n          };\n        }\n        return prevState;\n      });\n    }, 100);\n\n    // Add level up to battle log\n    setTimeout(() => {\n      addToBattleLog({\n        timestamp: new Date(),\n        type: 'levelup',\n        message: `レベルが${newLevel}に上がりました！`\n      });\n    }, 300);\n\n    return newPlayer;\n  }, [addToBattleLog]);\n\n  const handleCanvasClick = useCallback(() => {\n    if (!gameState.player.isAttacking) {\n      setGameState(handleAttack);\n    }\n  }, [gameState.player.isAttacking, handleAttack]);\n\n\n  const handleUpgrade = useCallback((type: UpgradeType) => {\n    setGameState(prevState => {\n      const newState: GameState = { ...prevState };\n      \n      switch (type) {\n        case 'attack':\n          if (newState.player.gold >= 10) {\n            newState.player = {\n              ...newState.player,\n              gold: newState.player.gold - 10,\n              attack: newState.player.attack + 5\n            };\n          }\n          break;\n        case 'autoAttack':\n          if (newState.player.gold >= 50 && !newState.autoAttack) {\n            newState.player = {\n              ...newState.player,\n              gold: newState.player.gold - 50\n            };\n            newState.autoAttack = true;\n          }\n          break;\n        case 'hp':\n          if (newState.player.gold >= 25) {\n            newState.player = {\n              ...newState.player,\n              gold: newState.player.gold - 25,\n              maxHp: newState.player.maxHp + 20,\n              hp: newState.player.maxHp + 20\n            };\n          }\n          break;\n        default:\n          break;\n      }\n      \n      return newState;\n    });\n  }, []);\n\n  const nextFloor = useCallback(() => {\n    setGameState(prevState => {\n      const newFloor = prevState.currentFloor + 1;\n      \n      // Check for new title unlocks based on floor\n      const newTitleUnlocks = checkNewTitleUnlocks(prevState.player.level, newFloor, prevState.unlockedTitles);\n      \n      return {\n        ...prevState,\n        currentFloor: newFloor,\n        monsters: [],\n        unlockedTitles: newTitleUnlocks.length > 0 \n          ? [...prevState.unlockedTitles, ...newTitleUnlocks.map(t => t.id)]\n          : prevState.unlockedTitles,\n        titleNotifications: newTitleUnlocks.length > 0\n          ? [...prevState.titleNotifications, ...newTitleUnlocks.map(t => t.name)]\n          : prevState.titleNotifications\n      };\n    });\n    \n    setTimeout(() => {\n      spawnMonster();\n    }, 100);\n  }, [spawnMonster]);\n\n  const handleDismissNotification = useCallback((index: number) => {\n    setGameState(prevState => ({\n      ...prevState,\n      titleNotifications: prevState.titleNotifications.filter((_, i) => i !== index)\n    }));\n  }, []);\n\n  const handleSpellUpgrade = useCallback((spellId: string) => {\n    setGameState(prevState => {\n      const currentLevel = prevState.magicSpells[spellId] || 0;\n      const cost = currentLevel === 0 ? 0 : getSpellUpgradeCost(spellId, currentLevel);\n      \n      if (currentLevel === 0) {\n        // Unlock spell\n        const availableSpells = getAvailableSpells(prevState.player.level);\n        const spell = availableSpells.find(s => s.id === spellId);\n        if (!spell || prevState.player.level < spell.unlockLevel) return prevState;\n        \n        return {\n          ...prevState,\n          magicSpells: {\n            ...prevState.magicSpells,\n            [spellId]: 1\n          }\n        };\n      } else {\n        // Upgrade spell\n        if (prevState.player.gold < cost) return prevState;\n        \n        return {\n          ...prevState,\n          player: {\n            ...prevState.player,\n            gold: prevState.player.gold - cost\n          },\n          magicSpells: {\n            ...prevState.magicSpells,\n            [spellId]: currentLevel + 1\n          }\n        };\n      }\n    });\n  }, []);\n\n  const handleSpellSelect = useCallback((spellId: string) => {\n    setGameState(prevState => ({\n      ...prevState,\n      currentSpell: spellId\n    }));\n  }, []);\n\n  return (\n    <div className=\"app\">\n      <div className=\"game-container\">\n        <GameDisplay \n          gameState={gameState}\n          onAttackClick={handleCanvasClick}\n          attackPhrase={currentAttackPhrase}\n        />\n        \n        <div className=\"ui-panel\">\n          <StatsPanel player={gameState.player} floor={gameState.currentFloor} />\n          <UpgradePanel \n            player={gameState.player}\n            autoAttack={gameState.autoAttack}\n            onUpgrade={handleUpgrade}\n            onNextFloor={nextFloor}\n          />\n        </div>\n        \n        <div className=\"bottom-panel\">\n          <BattleLog logs={gameState.battleLog} />\n          <MagicPanel \n            playerLevel={gameState.player.level}\n            playerGold={gameState.player.gold}\n            magicSpells={gameState.magicSpells}\n            currentSpell={gameState.currentSpell}\n            onSpellUpgrade={handleSpellUpgrade}\n            onSpellSelect={handleSpellSelect}\n          />\n          <Collection collection={gameState.collection} />\n        </div>\n      </div>\n      \n      <TitleNotification \n        notifications={gameState.titleNotifications}\n        onDismiss={handleDismissNotification}\n      />\n    </div>\n  );\n};\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}